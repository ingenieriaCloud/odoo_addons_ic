<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>
<template id="report_saleorder_document">
  <t t-set="company" t-value="res_company"/>

  <div class="page" style="margin-top:20px;">
    <div class="row">

      <!--
       <table class="table table-condensed">
         <tr>
	   <td>
	     <table class="table">
	       <tr>
		 <td style="color:#027ebc">DESCRIPCIÓN</td>
	       </tr>
	       <tr>
		 <td colspan="2" style="border: 1 solid #027ebc">
		   <p t-field="o.client_order_ref"/>
		 </td>
	       </tr>
	       <tr>
		 <td style="color:#027ebc">
		   <span style="color:#027ebc;" t-if="o.state not in ['draft','sent']">PEDIDO</span>
                   <span style="color:#027ebc;" t-if="o.state in ['draft','sent']">PRESUPUESTO</span>
		 </td>
	       </tr>
	       <tr>
		 <td style="border: 1 solid #027ebc">
		   <span style="color:#4d4d4d;">Fecha:</span> <strong><span t-field="o.date_order"/></strong><br/>
		   <span style="color:#4d4d4d;">Número:</span> <strong><span t-field="o.name"/></strong>
		 </td>
	       </tr>

	       <tr>
		 <td style="color:#027ebc">CLIENTE </td>
	       </tr>
	       <tr>
		 <td  colspan="2" style="border: 1 solid #027ebc">
		   <span t-if="o.partner_id.name" style="color:#4d4d4d;">Razón social:</span> <strong><span t-field="o.partner_id.name"/></strong><br/>
		   <span style="color:#4d4d4d;">Dirección:</span>
		   <strong><address t-field="o.partner_id" t-field-options='{"widget": "contact", "fields": ["address"], "no_marker": true}' />
                   <span t-if="o.partner_id.vat" style="color:#4d4d4d;"> CIF:</span> <span t-field="o.partner_id.vat"/>
		   </strong>
		 </td>
	       </tr>

	     </table>
	   </td>
	   
	   <td style="width:50%;float:right;margin-left:20px">
	     <div class="col-xs-12" style="display: inline-block; vertical-align: middle;">
	       <img t-if="company.logo" t-att-src="'data:image/png;base64,%s' % company.logo" style="max-height: 70px;"/><br/>
	     </div>
	     <div class="col-xs-12" style="font-size:12pt;">
	       <span t-field="company.name"/><br/>
	       <span t-field="company.street"/><br/>
	       <span t-field="company.zip"/> - <span t-field="company.city"/> - Murcia<br/>
	       <span t-field="company.vat"/><br/>
	     </div>

	   </td>
	 </tr>
       </table> 
      -->

      	    
	    <div class="col-xs-6" style="font-size:11pt;">
	     <table class="table-condensed" style="font-size:11pt;float:left;width:100%">
	       <tr>
		 <td style="color:#027ebc">DESCRIPCIÓN</td>
	       </tr>
	       <tr>
		 <td colspan="2" style="border: 1 solid #027ebc">
		   <p t-field="o.client_order_ref"/>
		 </td>
	       </tr>
	       <tr>
		 <td style="color:#027ebc">
		   <span style="color:#027ebc;" t-if="o.state not in ['draft','sent']">PEDIDO</span>
                   <span style="color:#027ebc;" t-if="o.state in ['draft','sent']">PRESUPUESTO</span>
		 </td>
	       </tr>
	       <tr>
		 <td style="border: 1 solid #027ebc">
		   <span style="color:#4d4d4d;">Fecha:</span> <strong><span t-field="o.date_order"/></strong><br/>
		   <span style="color:#4d4d4d;">Número:</span> <strong><span t-field="o.name"/></strong><br/>
		 </td>
	       </tr>

	       <tr>
		 <td style="color:#027ebc">CLIENTE </td>
	       </tr>
	       <tr>
		 <td colspan="2" style="border: 1 solid #027ebc">
		   <span t-if="o.partner_id.name" style="color:#4d4d4d;">Razón social:</span> <strong><span t-field="o.partner_id.name"/></strong><br/>
		   <span style="color:#4d4d4d;">Dirección:</span>
		   <strong><address t-field="o.partner_id" t-field-options='{"widget": "contact", "fields": ["address"], "no_marker": true}' />
                   <span t-if="o.partner_id.vat" style="color:#4d4d4d;"> CIF:</span> <span t-field="o.partner_id.vat"/>
		   </strong>
		 </td>
	       </tr>
	     </table>
	    </div>

	    <div class="col-xs-5" style="float:right;font-size:12pt">
	      <div style="display: inline-block; vertical-align: middle;">
		<img t-if="company.logo" t-att-src="'data:image/png;base64,%s' % company.logo" style="max-height: 70px;"/><br/>
		<span t-field="company.name"/><br/>
		<span t-field="company.street"/><br/>
		<span t-field="company.zip"/> - <span t-field="company.city"/> - Murcia<br/>
		<span t-field="company.vat"/><br/>
	     </div>
	    </div>
	  </div> <!-- row -->


	  <div class="row" style="margin-top:25px">
	 
       <table class="table table-condensed">
         <thead>
           <tr style="color:#027ebc; border-bottom: 1px solid #027ebc;">
             <th>Descripción</th>
           <!--  <th>Impuestos</th> -->
             <th class="text-right">Cantidad</th>
             <th class="text-right">Precio unidad</th>
             <th groups="sale.group_discount_per_so_line">Descuento (%)</th>
             <th class="text-right">Importe</th>
           </tr>
         </thead>
	 
	 <tbody style="border-top: 1px solid #027ebc">
	   <t t-foreach="o.sale_layout_lines(order_id = o.id)" t-as="p">
             <!-- Name of the category -->
             <span style="color:#027ebc">
	       <t t-if="p['category']">
		 <tr style="color: #027ebc;">
		   <td colspan="100" style="font-weight: bold; border-top: 1px solid #027ebc; border-bottom: 1px solid #027ebc;"> 
                     <t t-if="p['category'].name">
                       <b><t t-esc="p['category'].name"></t></b>
                     </t>
                     <t t-if="not p['category'].name">
                       --
                     </t>
		   </td>
		 </tr>
	       </t>
    	     </span>
	     
               <!-- Lines associated -->
               <t t-foreach="p['lines']" t-as="l">
                        <tr style="border-top: 1px solid #027ebc;">
                          <td>
                            <span  t-field="l.name"/>
                          </td>
			  <!--
                          <td>
                            <span t-esc="', '.join(map(lambda x: x.name, l.tax_id))"/>
                            </td>
			  -->
                          <td class="text-right">
                            <span t-field="l.product_uom_qty"/>
                            <span groups="product.group_uom" t-field="l.product_uom"/>
                          </td>
                          <td class="text-right">
                            <span t-field="l.price_unit"/>
                          </td>
                            <td groups="sale.group_discount_per_so_line">
                              <span t-field="l.discount"/>
                            </td>
                            <td class="text-right">
                              <span t-field="l.price_subtotal"
                                    t-field-options='{"widget": "monetary", "display_currency": "o.pricelist_id.currency_id"}'/>
                            </td>
                        </tr>
               </t>

	        <!-- Subtotal -->
		<t t-if="'subtotal' in p['category'] and p['category'].subtotal is True">
		  <tr class="text-right">
		    <td colspan="100">
                      <strong>Total partida: </strong>
                      <span t-esc="p['subtotal']" t-esc-options='{"widget": "monetary", "display_currency": "o.currency_id"}'/>
		    </td>
		  </tr>
		</t>
	       
		<!-- Separator -->
		<t t-if="'separator' in p['category'] and p['category'].separator is True">
		  <tr class="text-center">
		    <td colspan="100">
                      
		    </td>
		  </tr>
		</t>
	       
	       <!-- Pagebreak -->
               <t t-if="'pagebreak' in p['category'] and p['category'].pagebreak is True">
                 <t t-if="p_index &lt; p_size - 1">
                   <![CDATA[
                            </tbody>
                            </table>
                            <p style="page-break-before:always;"> </p>
                            <table class="table table-condensed">
                   ]]>
                   <thead>
                     <tr>
                       <th>Description</th>
                      <!-- <th>Taxes</th> -->
                       <th class="text-right">Quantity</th>
                       <th class="text-right">Unit Price</th>
                       <th groups="sale.group_discount_per_so_line">Disc.(%)</th>
                       <th class="text-right">Price</th>
                     </tr>
                   </thead>
                   <![CDATA[
                            <tbody>
                   ]]>
                 </t>
               </t>
             </t>
	     </tbody>
	   </table>
	 </div>
	 
         <div class="row" >
                <div class="col-xs-4 pull-right">
                    <table class="table table-condensed">
                        <tr class="" style="border-top: 1px solid #027ebc;">
                            <td><strong>Subtotal</strong></td>
                            <td class="text-right">
                                <span t-field="o.amount_untaxed"
                                    t-field-options='{"widget": "monetary", "display_currency": "o.pricelist_id.currency_id"}'/>
                            </td>
                        </tr>
		<!--	<tr>
                            <td>Impuestos</td>
                            <td class="text-right">
                                <span t-field="o.amount_tax"
                                    t-field-options='{"widget": "monetary", "display_currency": "o.pricelist_id.currency_id"}'/>
                            </td>
                            </tr>
		-->
                        <tr class="" style="border-top: 1px solid #027ebc;">
                            <td style="background-color: #027ebc; border: 1px solid #027ebc; color:#ffffff; "><strong>TOTAL</strong></td>
                            <td class="text-right" style="border: 1px solid #027ebc;">
                                <strong><span t-field="o.amount_total"
                                t-field-options='{"widget": "monetary", "display_currency": "o.pricelist_id.currency_id"}'/>
				</strong>
                            </td>
                        </tr>
                    </table>
		</div>
         </div>
	    
            <div class="row">
	      <div class="col-xs-10">
		<span style="color:#027ebc;" t-if="o.note">Condiciones de pago:</span>
		<p t-field="o.note" />
		<div class="oe_structure"/>
		<span style="color:#027ebc;">Observaciones:</span> Dicha oferta tiene una validez de 30 días
	      </div>
	    </div>
	    
          </div>
	  
	<div class="footer">
            <div class="text-center" style="border-top: 1px solid #027ebc;">
              <ul t-if="not company.custom_footer" class="list-inline">
                <li t-if="company.phone">Teléfono: <span t-field="company.phone"/></li>
                <li t-if="company.fax and company.phone">&amp;bull;</li>
                <li t-if="company.email">&amp;bull;</li>
                <li t-if="company.email">Email: <span t-field="company.email"/></li>
                <li t-if="company.website">&amp;bull;</li>
                <li t-if="company.website">Web: <span t-field="company.website"/></li>
              </ul>
              <t t-if="company.custom_footer"> <span t-raw="company.rml_footer"/> </t>
              <ul class="list-inline">
                <li>Página:</li>
                <li><span class="page"/></li>
                <li>/</li>
                <li><span class="topage"/>
                </li>
              </ul>
            </div>
          </div> 

	
	
</template>

<template id="report_saleorder">
    <t t-call="report.html_container">
        <t t-foreach="doc_ids" t-as="doc_id">
            <t t-raw="translate_doc(doc_id, doc_model, 'partner_id.lang', 'konery_custom_order.report_saleorder_document')"/>
        </t>
    </t>
</template>
      
</data>
</openerp>
